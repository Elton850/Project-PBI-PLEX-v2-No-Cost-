<%
  const body = `
    <div class="topbar">
      <div>
        <h2>Departamentos</h2>
        <div class="muted">Administração</div>
      </div>
      <div style="display:flex;gap:8px;align-items:center;">
        <a class="chip chip-active" href="/admin/departments/new">Novo departamento</a>
      </div>
    </div>

    <div class="card" style="width:100%; max-width:1100px;">
      <table class="table">
        <thead>
          <tr>
            <th>Nome</th>
            <th>PLEX</th>
            <th>GRD</th>
            <th>UGB</th>
            <th>Ações</th>
          </tr>
        </thead>
        <tbody>
          ${(depts || []).map(d => `
            <tr>
              <td>${d.name}</td>
              <td><span class="muted">${d.plexUrl ? "OK" : "-"}</span></td>
              <td><span class="muted">${d.grdUrl ? "OK" : "-"}</span></td>
              <td><span class="muted">${d.ugbUrl ? "OK" : "-"}</span></td>
              <td style="display:flex;gap:8px;align-items:center;">
                <a class="chip" href="/admin/departments/${d.id}/edit">Editar</a>
                <form method="post" action="/admin/departments/${d.id}/delete" onsubmit="return confirm('Excluir departamento?');">
                    <button type="submit" class="btn-danger">Excluir</button>
                </form>
              </td>
            </tr>
          `).join("")}
        </tbody>
      </table>
    </div>
  `;
%>
<%- include("layout", { title: "Departamentos", body, me, module: null, currentDept: null }) %>
